<!doctype html>
<html>
<head>
  <title>Weather App</title>
  <meta charset="utf-8" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
  <link type="stylesheet" href="style.css">
  <link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
</head>
<style>
  body {
    font-family: 'Lato', sans-serif;
    text-align: center;
    background-color: darkgreen;
    color: white;
  }

  p {
    font-size:18px;
  }

  button {
    padding:10px 10px 10px 10px;
    font-size:16px;
  }

  button:hover {
    background-color: black;
    color:white;
  }

</style>
<body>
  <div class="body">
  <header>
    <h1>Your Weather</h1>
  </header>
  <main>
    <p id="data"></p>
    <p id="city">City :</p>
    <p id="temperature">Temp :</p>
    <button id="convert">Convert to Celsius</button>
    <p id="forecast">Currently :</p>
    <p id="icon"></p>
    <p id="time"></p>
  </main>
  <footer>
  </footer>
</div>
  <script>
  var icons = {
    "thunderstorm":"http://openweathermap.org/img/w/11", // id 200-232, 960-962,
    "drizzle":"http://openweathermap.org/img/w/09", // 300-321
    "rain":"http://openweathermap.org/img/w/10", // 500-531
    "snow":"http://openweathermap.org/img/w/13", // 600-622
    "atmosphere":"http://openweathermap.org/img/w/50", // 701-781
    "cleared":"http://openweathermap.org/img/w/01", // 800, 951-956
    "clouds":"http://openweathermap.org/img/w/03" // 801-804
  };
  function getIcon (x) {
    if (x > 199 && x < 233) {
      return icons.thunderstorm;
    } else if (x > 959 && x < 963) {
      return icons.thunderstorm;
    } else if (x > 299 && x < 322) {
      return icons.drizzle;
    } else if (x > 599 && x < 623) {
      return icons.snow;
    } else if (x > 700 && x < 782) {
      return icons.atmosphere;
    } else if (x > 951 && x < 957) {
      return icons.cleared;
    } else if (x > 800 && x < 805) {
      return icons.clouds;
    } else {
      return icons.cleared;
    }
  }
  var long, lati, weatherData, url3, fTemp;
  if (navigator.geolocation) {
  	navigator.geolocation.getCurrentPosition(function(position) {
      long = (Math.round((position.coords.longitude)*1000))/1000;
      lati = (Math.round((position.coords.latitude)*1000))/1000;
      url3 = ('http://api.openweathermap.org/data/2.5/weather?lat='+lati+'&lon='+long+'&APPID=f6528aa612e42b74b4f7bcf00cd1b0b1');
      $.get(url3).success(function(data) {
        weatherData = data;
        var temp = (1.8 * (weatherData["main"]["temp"] - 273)) + 32;
        fTemp = Math.round(temp);
        var current = weatherData.weather[0].main;
        $('#city').html("City : "+weatherData.name);
        $('#temperature').html("Temp : "+fTemp+"&deg; F");
        $('#forecast').html("Currently : "+current);
        var y = getIcon(weatherData["weather"]["id"]);
        var z = new Date();
        var hour = z.getHours();
        if (hour > 7 && hour < 18) {
          var p = 'd.png';
        } else { p = 'n.png' }
        $('#icon').html('<img src="'+y+p+'"/>');
        });
  	});
  // f6528aa612e42b74b4f7bcf00cd1b0b1
}
var statusTemp = "F";
$(document).ready(function() {
  $('#convert').click(function() {
    if (statusTemp == "F") {
      $('#convert').html("Convert to Fahrenheit");
      fTemp = ((fTemp - 32) * 5 )/ 9;
      var cTemp = (Math.round((fTemp)*10))/10;
      $('#temperature').html("Temp : "+cTemp+"&deg; C");
      statusTemp = "C"
    } else if (statusTemp == "C") {
      $('#convert').html("Convert to Celsius");
      fTemp = ((fTemp * 9) / 5 ) + 32;
      $('#temperature').html("Temp : "+fTemp+"&deg; F");
      statusTemp = "F";
    }
  });

});
  </script>
</body>
</html>
